library(ggplot2)
library(tidyverse)
n2000  <- read.csv("n2000.csv", sep = ";", encoding = "latin1")
n2000  <- read.csv("n2000.csv", sep = ";", encoding = "latin1")
n2000 <- read.csv("n2000.csv" , sep=";" , encoding="latin1")
---
output:
word_document: default
title: "Tp_1_ Statistique"
library(ggplot2)
library(tidyverse)
n2000  <- read.csv("n2000 (1).csv",sep = ";", encoding = "latin1")
n2000  <- read.csv("n2000.csv",sep = ";", encoding = "latin1")
```{r}
plot(unlist(n2000[5]),unlist(n2000[6]))
ggplot(data= n2000)+
aes(x = long,
y = lat,
color = biogeo) +
geom_point()
plot(unlist(n2000[5]),unlist(n2000[6]))
plot(unlist(n2000[5]),unlist(n2000[6]))
ggplot(data= n2000)+
aes(x = long,
y = lat,
color = biogeo) +
geom_point()
skewness <- function(data){
n <- length(data)
m <- mean(data)
e <- sd(data)
skew <- (1/n) * sum(((data - m) / e) ^ 3)
return(skew)
}
kurtosis <- function(data) {
n <- length(data)
m <- mean(data)
e <- sd(data)
kurt <- (1/n) * sum(((data - m) / e) ^ 4)
return(kurt)
}
n2000_q <- sapply(n2000,is.numeric)
n2 <- n2000[n2000_q]
n2 <- n2[-1]
summary_results <- lapply(n2, function(x) {c(summary(x),skewness = skewness(x),kurtosis = kurtosis(x))})
hist(n2[1:1561,1],breaks=  log(1561),freq= FALSE)
hist(n2[1:1561,2],breaks= log(1561),freq= FALSE)
hist(n2[1:1561,3],breaks =log(1561),freq= FALSE)
hist(n2[1:1561,4],breaks = log(1561),freq= FALSE)
hist(n2[1:1561,5],breaks= log(1561),freq= FALSE)
hist(n2[1:1561,6],breaks= log(1561),freq= FALSE)
hist(n2[1:1561,7],breaks= log(1561),freq= FALSE)
hist(n2[1:1561,8],breaks = log(1561),freq= FALSE)
boxplot(n2$code,breaks=log(1561),freq= FALSE)
boxplot(n2$surf,breaks=  log(1561),freq= FALSE)
boxplot(n2$long,breaks=  log(1561),freq= FALSE)
boxplot(n2$lat,breaks=  log(1561),freq= FALSE)
boxplot(n2[1:1561,5],breaks=  log(1561),freq= FALSE)
boxplot(n2[1:1561,6],breaks=  log(1561),freq= FALSE)
boxplot(n2[1:1561,7],breaks=  log(1561),freq= FALSE)
boxplot(n2[1:1561,8],breaks=  log(1561),freq= FALSE)
tapply(n2, 1, function(x) {c(summary(x),ap_s(x),ap_k(x))})
n2000[9]
tapply(n2, 1, function(x) {c(summary(x),ap_s(x),ap_k(x))})
?ap_s
?ap_s
??ap_s’
??ap_s
tapply(n2, 1, function(x) {c(summary(x),ap_s(x),ap_k(x))})
lapply(n2, 1, function(x) {c(summary(x),ap_s(x),ap_k(x))})
tapply(n2, 1, function(x) {c(summary(x),ap_s(x),ap_k(x))})
import ap_s
import ap
import ap_k
?tapply(vector, index, function)
?tapply
effreq <- data.frame(effectif =table( n2000$biogeo),fréquence  = effreq[1:4,2]/1561*100)
?effreq
??effreq
s_tot <- sum(n2000$surf)
tsurface <- data.frame(surface = tapply(n2000$surf,n2000$biogeo,sum),
pourcentage = (tapply(n2000$surf,n2000$biogeo,sum)/s_tot)*100)
n <- c("Alpine","Atlantique","Continentale", "Méditerranéenne")
barplot(effreq$effectif.Freq,names.arg = effreq$effectif.Var1)
effreq <- data.frame(effectif =table( n2000$biogeo),fréquence  = effreq[1:4,2]/1561*100)
effreq <- data.frame(effectif =table( n2000$biogeo),
fréquence  = effreq[1:4,2]/1561*100)
ggplot(effreq)+
aes(x=effectif.Var1,
y=effectif.Freq)+
labs(x = "",
y = "",
title = "Zone n2000 selon les catégories géologique")+
geom_col()
tsurface
ggplot(tsurface[1])+
aes(x=n,
y=surface)+
labs(x = "biogeo",
title = "Surface n2000 selon les catégories géologique")+
geom_col()
effreq <- data.frame(effectif =table( n2000$biogeo),fréquence  == effreq[1:4,2]/1561*100)
effreq <- data.frame(effectif =table( n2000$biogeo),frequence  == effreq[1:4,2]/1561*100)
effreq <- data.frame(effectif =table( n2000$biogeo),frequence  = effreq[1:4,2]/1561*100)
effreq <- data.frame(effectif =table( n2000$biogeo)
s_tot <- sum(n2000$surf)
s_tot <- sum(n2000$surf)
tsurface <- data.frame(surface = tapply(n2000$surf,n2000$biogeo,sum),
pourcentage = (tapply(n2000$surf,n2000$biogeo,sum)/s_tot)*100)
n <- c("Alpine","Atlantique","Continentale", "Méditerranéenne")
barplot(effreq$effectif.Freq,names.arg = effreq$effectif.Var1)
effreq <- data.frame(effectif =table( n2000$biogeo))
s_tot <- sum(n2000$surf)
tsurface <- data.frame(surface = tapply(n2000$surf,n2000$biogeo,sum),
pourcentage = (tapply(n2000$surf,n2000$biogeo,sum)/s_tot)*100)
n <- c("Alpine","Atlantique","Continentale", "Méditerranéenne")
barplot(effreq$effectif.Freq,names.arg = effreq$effectif.Var1)
print(effreq)
ggplot(effreq)+
aes(x=effectif.Var1,
y=effectif.Freq)+
labs(x = "",
y = "",
title = "Zone n2000 selon les catégories géologique")+
geom_col()
tsurface
ggplot(tsurface[1])+
aes(x=n,
y=surface)+
labs(x = "biogeo",
title = "Surface n2000 selon les catégories géologique")+
geom_col()
effreq <- data.frame(effectif =table( n2000$biogeo),frequence  = effreq[1:4,2]/1561*100)
effreq <- data.frame(effectif =table( n2000$biogeo),frequence  = effreq[1:4,2]/1561*100)
s_tot <- sum(n2000$surf)
tsurface <- data.frame(surface = tapply(n2000$surf,n2000$biogeo,sum),
pourcentage = (tapply(n2000$surf,n2000$biogeo,sum)/s_tot)*100)
n <- c("Alpine","Atlantique","Continentale", "Méditerranéenne")
barplot(effreq$effectif.Freq,names.arg = effreq$effectif.Var1)
print(effreq)
ggplot(effreq)+
aes(x=effectif.Var1,
y=effectif.Freq)+
labs(x = "",
y = "",
title = "Zone n2000 selon les catégories géologique")+
geom_col()
tsurface
ggplot(tsurface[1])+
aes(x=n,
y=surface)+
labs(x = "biogeo",
title = "Surface n2000 selon les catégories géologique")+
geom_col()
install.packages("GGally")
cor(n2[2:8])
pairs(n2[2:8])
pairs(n2[2:8])
library(GGally)
library(GGally)
ggpairs(n2)
for (i in 1:(ncol(n2))) {
for (j in (i +1):ncol(n2)-1) {
print(cor.test(n2[,i], n2[,j]))
print(i)
print(j)
}
}
ggpairs(n2)
for (i in 1:(ncol(n2))) {
for (j in (i +1):ncol(n2)-1) {
print(cor.test(n2[,i], n2[,j]))
print(i)
print(j)
}
}
cor(n2[2:8])
pairs(n2[2:8])
pairs(n2[2:8])
library(GGally)
ggpairs(n2)
for (i in 1:(ncol(n2))) {
for (j in (i +1):ncol(n2)-1) {
print(cor.test(n2[,i], n2[,j]))
print(i)
print(j)
}
}
lm(formula = n2$activmoins ~n2$activplus)
plot(x = n2$activmoins, y = n2$activplus,abline(lm(formula = n2$activmoins ~n2$activplus)))
intervalles <- c(1, 3, 6, 11, 21,Inf)
n2$classes <- cut(n2$nbcom, breaks = intervalles, labels = c("1 ou 2 communes", "3 à 5 communes", "6 à 10 communes", "11 à 20 communes","21 communes ou plus"))
t_con <- table(n2$classes,n2000$biogeo)
barplot(t_con)
n <- c(mean(n2$surf))
c(mean(n2$surf,group = n2$biogeo))
var(x = n2$surf,y = n2$nbcom)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
```{r}
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
n2000 <- read.csv("n2000.CSV", sep=";", encoding="latin1")
plot(unlist(n2000[5]),unlist(n2000[6]))
library(tidyverse)
ggplot(data = n2000) +
aes(x = long,
y = lat,
color=biogeo) +
geom_point()
skewness  <- function(x) {
n <- length(x)
mean_x <- mean(x)
sd_x <- sd(x)
skew <- sum((x - mean_x)^3) / (n * sd_x^3)
return(skew)
}
kurtosis <- function(x) {
n <- length(x)
mean_x <- mean(x)
sd_x <- sd(x)
kurt <- sum((x - mean_x)^4) / (n * sd_x^4) - 3
return(kurt)
}
n2000_apply <- sapply(n2000,is.numeric)
n2000_summary <- n2000[n2000_apply]
n2000_summary <- n2000 |>
select(surf,long,lat,alt,nbcom,activplus,activmoins)
n2000_summary <- n2000_summary[-1]
summary_results <- lapply(n2000_summary, function(x) {c(summary(x),skewness = skewness(x),kurtosis = kurtosis(x), sd=sd(x))})
boxplot(x=unlist(summary_results[5]))
lapply(summary_results, function(x) {c(hist(x=x,breaks=4),boxplot(x=x))})
unlisted_n2000 <- unlist(n2000);
table_n2000 <- table(unlisted_n2000)
effectif <-c(table_n2000["Alpine"],table_n2000["Atlantique"],table_n2000["Continentale"],table_n2000["Méditerranéenne"])
total_pc <- sum(effectif)/100
effreq <- df <- data.frame(
effectifs = effectif,
fréquences = c(table_n2000["Alpine"]/total_pc, table_n2000["Atlantique"]/total_pc, table_n2000["Continentale"]/total_pc,table_n2000["Méditerranéenne"]/total_pc)
)
s_alpine <-0
s_atlantique<-0
s_continental <- 0
s_medi<-0
longueur <- lengths(n2000[1])
for (i in 1:longueur) {
if (n2000[i,9] == "Alpine"){
s_alpine <- s_alpine+ n2000[i,4]
}
else if (n2000[i,9] == "Atlantique"){
s_atlantique <- s_atlantique+ n2000[i,4]
}
else if (n2000[i,9] == "Continentale") {
s_continental <- s_continental + n2000[i,4]
}
else if (n2000[i,9] == "Méditerranéenne") {
s_medi <- s_medi + n2000[i,4]
}
}
s_total_p<-(s_alpine+s_atlantique+s_continental+s_medi)/100
tsurface <- df <- data.frame(
surface = c(s_alpine,s_atlantique,s_continental,s_medi),
pourcentage = c(s_alpine/s_total_p, s_atlantique/s_total_p, s_continental/s_total_p,s_medi/s_total_p)
)
rownames(tsurface) <- c("Alpine", "Atlantique", "Continentale", "Méditerranéenne")
noms_barres <- c("Alpine", "Atlantique", "Continentale", "Méditerranéenne")
barplot(unlist(effreq[1]), horiz = TRUE,
names.arg = noms_barres,
main = "Zones N2000 selon les catégories géobiologiques",
las = 1)
barplot(unlist(tsurface[1]),
names.arg = noms_barres,
main = "Zones N2000 selon les catégories géobiologiques",
las = 1)
effreq_tibble <- as_tibble(effreq)
effreq_tibble <- effreq_tibble |>
add_column( noms_barres, .before = 1)
tsurface_tibble <- as_tibble(tsurface)
tsurface_tibble <- tsurface_tibble |>
add_column( noms_barres, .before = 1)
ggplot(data = effreq) +
aes(x = noms_barres,
y=effectif) +
geom_col()
ggplot(data = tsurface_tibble) +
aes(x = noms_barres,
y=surface) +
geom_col()
#pour rappel n_2000_summary est équivalent à toutes les données quantitatives de n2000 qui nous interressent,
cor(x=n2000_summary)
pairs(x=n2000_summary)
pairs(x=n2000_summary)
library(GGally)
ggpairs(n2000_summary)
pairs(x=n2000_summary)
library(GGally)
ggpairs(n2000_summary)
for (i in 1:(ncol(n2000_summary) - 1)) {
for (j in (i + 1):ncol(n2000_summary)) {
cor.test(n2000_summary[,i], n2000_summary[,j])# on peut le print
}
}
lm(formula = n2000_summary$activmoins ~n2000_summary$activplus)
plot(x = n2000_summary$activmoins, y = n2000_summary$activplus,abline(lm(formula = n2000_summary$activmoins ~n2000_summary$activplus)))
print("Les points sont principalements autour de la droite, mais, plus la valeur est élevé, plus les points sont au dessus de la droite")
intervalles <- c(1, 3, 6, 11, 21,Inf)
n2000_summary$classes <- cut(n2000_summary$nbcom, breaks = intervalles, labels = c("1 ou 2 communes", "3 à 5 communes", "6 à 10 communes", "11 à 20 communes","21 communes ou plus"))
tcom <- table(n2000_summary$classes,n2000$biogeo)
barplot(tcom)
plot(x = n2000_summary$activmoins, y = n2000_summary$activplus,abline(lm(formula = n2000_summary$activmoins ~n2000_summary$activplus)))
print("Les points sont principalements autour de la droite, mais, plus la valeur est élevé, plus les points sont au dessus de la droite")
intervalles <- c(1, 3, 6, 11, 21,Inf)
n2000_summary$classes <- cut(n2000_summary$nbcom, breaks = intervalles, labels = c("1 ou 2 communes", "3 à 5 communes", "6 à 10 communes", "11 à 20 communes","21 communes ou plus"))
tcom <- table(n2000_summary$classes,n2000$biogeo)
barplot(tcom)
lm(formula = n2$activmoins ~n2$activplus)
plot(x = n2$activmoins, y = n2$activplus,abline(lm(formula = n2$activmoins ~n2$activplus)))
intervalles <- c(1, 3, 6, 11, 21,Inf)
n2$classes <- cut(n2$nbcom, breaks = intervalles, labels = c("1 ou 2 communes", "3 à 5 communes", "6 à 10 communes", "11 à 20 communes","21 communes ou plus"))
t_con <- table(n2$classes,n2000$biogeo)
barplot(t_con)
n <- c(mean(n2$surf))
c(mean(n2$surf,group = n2$biogeo))
var(x = n2$surf,y = n2$nbcom)
barplot(tcom)
library(ggplot2)
library(tidyverse)
n2000  <- read.csv("n2000.csv",sep = ";", encoding = "latin1")
plot(unlist(n2000[5]),unlist(n2000[6]))
plot(unlist(n2000[5]),unlist(n2000[6]))
ggplot(data= n2000)+
aes(x = long,
y = lat,
color = biogeo) +
geom_point()
skewness  <- function(x) {
n <- length(x)
mean_x <- mean(x)
sd_x <- sd(x)
skew <- sum((x - mean_x)^3) / (n * sd_x^3)
return(skew)
}
kurtosis <- function(x) {
n <- length(x)
mean_x <- mean(x)
sd_x <- sd(x)
kurt <- sum((x - mean_x)^4) / (n * sd_x^4) - 3
return(kurt)
}
n2000_apply <- sapply(n2000,is.numeric)
n2000_summary <- n2000[n2000_apply]
n2000_summary <- n2000 |>
select(surf,long,lat,alt,nbcom,activplus,activmoins)
n2000_summary <- n2000_summary[-1]
summary_results <- lapply(n2000_summary, function(x) {c(summary(x),skewness = skewness(x),kurtosis = kurtosis(x), sd=sd(x))})
boxplot(x=unlist(summary_results[5]))
lapply(summary_results, function(x) {c(hist(x=x,breaks=4),boxplot(x=x))})
unlisted_n2000 <- unlist(n2000);
table_n2000 <- table(unlisted_n2000)
effectif <-c(table_n2000["Alpine"],table_n2000["Atlantique"],table_n2000["Continentale"],table_n2000["Méditerranéenne"])
total_pc <- sum(effectif)/100
effreq <- df <- data.frame(
effectifs = effectif,
fréquences = c(table_n2000["Alpine"]/total_pc, table_n2000["Atlantique"]/total_pc, table_n2000["Continentale"]/total_pc,table_n2000["Méditerranéenne"]/total_pc)
)
s_alpine <-0
s_atlantique<-0
s_continental <- 0
s_medi<-0
longueur <- lengths(n2000[1])
for (i in 1:longueur) {
if (n2000[i,9] == "Alpine"){
s_alpine <- s_alpine+ n2000[i,4]
}
else if (n2000[i,9] == "Atlantique"){
s_atlantique <- s_atlantique+ n2000[i,4]
}
else if (n2000[i,9] == "Continentale") {
s_continental <- s_continental + n2000[i,4]
}
else if (n2000[i,9] == "Méditerranéenne") {
s_medi <- s_medi + n2000[i,4]
}
}
s_total_p<-(s_alpine+s_atlantique+s_continental+s_medi)/100
tsurface <- df <- data.frame(
surface = c(s_alpine,s_atlantique,s_continental,s_medi),
pourcentage = c(s_alpine/s_total_p, s_atlantique/s_total_p, s_continental/s_total_p,s_medi/s_total_p)
)
rownames(tsurface) <- c("Alpine", "Atlantique", "Continentale", "Méditerranéenne")
noms_barres <- c("Alpine", "Atlantique", "Continentale", "Méditerranéenne")
barplot(unlist(effreq[1]), horiz = TRUE,
names.arg = noms_barres,
main = "Zones N2000 selon les catégories géobiologiques",
las = 1)
barplot(unlist(tsurface[1]),
names.arg = noms_barres,
main = "Zones N2000 selon les catégories géobiologiques",
las = 1)
effreq_tibble <- as_tibble(effreq)
effreq_tibble <- effreq_tibble |>
add_column( noms_barres, .before = 1)
tsurface_tibble <- as_tibble(tsurface)
tsurface_tibble <- tsurface_tibble |>
add_column( noms_barres, .before = 1)
ggplot(data = effreq) +
aes(x = noms_barres,
y=effectif) +
geom_col()
ggplot(data = tsurface_tibble) +
aes(x = noms_barres,
y=surface) +
geom_col()
#pour rappel n_2000_summary est équivalent à toutes les données quantitatives de n2000 qui nous interressent,
cor(x=n2000_summary)
pairs(x=n2000_summary)
library(GGally)
ggpairs(n2000_summary)
ggpairs(n2000_summary)
for (i in 1:(ncol(n2000_summary) - 1)) {
for (j in (i + 1):ncol(n2000_summary)) {
cor.test(n2000_summary[,i], n2000_summary[,j])# on peut le print
}
}
print("activplus et activmoins sont très liés, les autres ne le sont pas du tout.")
print("activplus et activmoins sont très liés, les autres ne le sont pas du tout.")
}
}
#pour rappel n_2000_summary est équivalent à toutes les données quantitatives de n2000 qui nous interressent,
cor(x=n2000_summary)
pairs(x=n2000_summary)
ggpairs(n2000_summary)
for (i in 1:(ncol(n2000_summary) - 1)) {
for (j in (i + 1):ncol(n2000_summary)) {
cor.test(n2000_summary[,i], n2000_summary[,j])# on peut le print
}
}
ggpairs(n2000_summary)
for (i in 1:(ncol(n2000_summary) - 1)) {
for (j in (i + 1):ncol(n2000_summary)) {
cor.test(n2000_summary[,i], n2000_summary[,j])# on peut le print
}
}
lm(formula = n2$activmoins ~n2$activplus)
ggpairs(n2000_summary)
#pour rappel n_2000_summary est équivalent à toutes les données quantitatives de n2000 qui nous interressent,
cor(x=n2000_summary)
pairs(x=n2000_summary)
pairs(x=n2000_summary)
library(GGally)
library(GGally)
ggpairs(n2000_summary)
for (i in 1:(ncol(n2000_summary) - 1)) {
for (j in (i + 1):ncol(n2000_summary)) {
cor.test(n2000_summary[,i], n2000_summary[,j])# on peut le print
}
}
#pour rappel n_2000_summary est équivalent à toutes les données quantitatives de n2000 qui nous interressent,
cor(x=n2000_summary)
pairs(x=n2000_summary)
pairs(x=n2000_summary)
library(GGally)
ggpairs(n2000_summary)
for (i in 1:(ncol(n2000_summary) - 1)) {
for (j in (i + 1):ncol(n2000_summary)) {
cor.test(n2000_summary[,i], n2000_summary[,j])# on peut le print
}
}
lm(formula = n2$activmoins ~n2$activplus)
lm(formula = n2000_summary$activmoins ~n2000_summary$activplus)
plot(x = n2000_summary$activmoins, y = n2000_summary$activplus,abline(lm(formula = n2000_summary$activmoins ~n2000_summary$activplus)))
print("Les points sont principalements autour de la droite, mais, plus la valeur est élevé, plus les points sont au dessus de la droite")
intervalles <- c(1, 3, 6, 11, 21,Inf)
n2000_summary$classes <- cut(n2000_summary$nbcom, breaks = intervalles, labels = c("1 ou 2 communes", "3 à 5 communes", "6 à 10 communes", "11 à 20 communes","21 communes ou plus"))
tcom <- table(n2000_summary$classes,n2000$biogeo)
barplot(tcom)
intervalles <- c(1, 3, 6, 11, 21,Inf)
n2$classes <- cut(n2$nbcom, breaks = intervalles, labels = c("1 ou 2 communes", "3 à 5 communes", "6 à 10 communes", "11 à 20 communes","21 communes ou plus"))
t_con <- table(n2$classes,n2000$biogeo)
barplot(t_con)
n <- c(mean(n2$surf))
c(mean(n2$surf,group = n2$biogeo))
var(x = n2$surf,y = n2$nbcom)
lm(formula = n2$activmoins ~n2$activplus)
plot(x = n2$activmoins, y = n2$activplus,abline(lm(formula = n2$activmoins ~n2$activplus)))
intervalles <- c(1, 3, 6, 11, 21,Inf)
n2$classes <- cut(n2$nbcom, breaks = intervalles, labels = c("1 ou 2 communes", "3 à 5 communes", "6 à 10 communes", "11 à 20 communes","21 communes ou plus"))
t_con <- table(n2$classes,n2000$biogeo)
barplot(t_con)
n <- c(mean(n2$surf))
c(mean(n2$surf,group = n2$biogeo))
var(x = n2$surf,y = n2$nbcom)
varp <- c(mean(n2$surf))
var(x = n2$surf,y = n2$nbcom)
rcorr
# Définition de la fonction varp pour calculer la variance de population
varp <- function(x) {
n <- length(x)
mean_x <- mean(x)
sum_squares <- sum((x - mean_x)^2)
variance <- sum_squares / n
return(variance)
}
# Exemple de données (remplacez avec vos propres données)
data <- data.frame(surf = c(10, 20, 15, 25, 30),
libgeo = c("A", "A", "B", "B", "C"))
# Calcul des moyennes et des variances de surf selon les niveaux de libgeo
means <- tapply(data$surf, data$libgeo, mean)
# Affichage des résultats
result <- data.frame(libgeo = names(means), moyenne_surf = means, variance_surf = variances)
variances <- tapply(data$surf, data$libgeo, varp)
# Affichage des résultats
result <- data.frame(libgeo = names(means), moyenne_surf = means, variance_surf = variances)
